# ending-session 設計メモ

スキル管理用メタデータ。実行時には読み込まれない。

## コンセプト

セッション終了時に引き継ぎ Discussion の作成と Issue ステータスの自動更新を実行する。引き継ぎは**必須**（短いセッションでも省略不可）。

### ステータス自動ルーティング

PR の状態から遷移先を自動判定し、ユーザーの推測を不要にする。

| PR 状態 | 遷移先 |
|---------|--------|
| マージ済み | Done |
| オープン | Review |
| なし | 変更なし |

### 信頼性設計

- **プリフライト**: `session preflight` 1 コマンドで全状態（ブランチ、未コミット変更、未プッシュコミット、Issue、PR、バックアップ）を一括取得
- **ローカルフォールバック**: CLI 失敗時に `.claude/sessions/` にローカル保存
- **冪等性**: 他スキルが既にステータス更新済みでもエラーにならない

## トリガーキーワード

SKILL.md の frontmatter `description` フィールドに定義。スキル選択はこのフィールドでマッチングされる。

- "セッション終了", "作業終了", "end session", "引き継ぎ保存"
